name: Repository update (admin)
on:
#  repository_dispatch:
#    types: ["Repository update"]
  schedule:
    - cron: "00 3 * * *"
  workflow_dispatch:
    inputs:
      BUILD_BRANCH:
        description: Build branch
        required: false
        default: main
        type: string
      BUILD_RUNNER:
        description: Build runner
        required: false
        default: ubuntu-latest
        type: string
      TARGET_REPOSITORY:
        type: choice
        description: Select repository
        options:
        - beta.armbian.com
        - apt.armbian.com
      UPDATE_REPOSITORY:
        type: boolean
        description: Update repository
        default: true

concurrency:
  group: repository-${{ github.ref }}
  cancel-in-progress: false

jobs:

  gradle:
    strategy:
      fail-fast: false
      max-parallel: 8
      matrix:
        repository: ["apt.armbian.com","beta.armbian.com"]
    
    name: rerun
    runs-on: repository
    steps:
    
      - name: "Prepare for ${{ matrix.repository }}"
        run: |
          tree /incoming
